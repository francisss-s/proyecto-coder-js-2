<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Pel칤culas y Series</title>
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/base.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    <script type="module">
        import { 
            mostrarPopupAuth, 
            cerrarPopupAuth, 
            registrarUsuario, 
            autenticarUsuario, 
            agregarElemento, 
            buscarElemento, 
            ordenarPorCategoria, 
            abrirPopup,
            cerrarPopup,
            cerrarPopupCategoria,
            agregarCategoria,
            guardarEdicion
        } from './scripts.js';

        // Asigna las funciones a window para que puedan ser accesibles en el HTML
        window.mostrarPopupAuth = mostrarPopupAuth;
        window.cerrarPopupAuth = cerrarPopupAuth;
        window.registrarUsuario = registrarUsuario;
        window.autenticarUsuario = autenticarUsuario;
        window.agregarElemento = agregarElemento;
        window.buscarElemento = buscarElemento;
        window.ordenarPorCategoria = ordenarPorCategoria;
        window.abrirPopup = abrirPopup;
        window.cerrarPopup = cerrarPopup;
        window.cerrarPopupCategoria = cerrarPopupCategoria;
        window.agregarCategoria = agregarCategoria;
        window.guardarEdicion = guardarEdicion;
    </script>
</head>
<body>
    <!-- Div que solo ser치 visible en desktop -->
    <div class="desktop">
        <h1>춰Ups! 游뗻</h1>
        <p>Esta p치gina solo es visible en dispositivos m칩viles.</p>
    </div>
    
    <div class="container">
        <header>
            <h1>Control de Pel칤culas y Series</h1>
            <input type="text" id="searchInput" placeholder="Buscar por nombre" onkeyup="buscarElemento()">
            <button class="sort-btn" onclick="ordenarPorCategoria()">Ordenar por Categor칤a</button>
            <button class="add-btn" onclick="abrirPopup('item')">+</button>
            <button class="auth-btn" onClick="mostrarPopupAuth('login')">Iniciar Sesi칩n</button>
            <button class="auth-btn" onClick="mostrarPopupAuth('register')">Registrarse</button>
        </header>
        
        <ul id="list"></ul>
        <ul id="categoriaList" class="hidden"></ul>
    </div>
    
    <!-- Popup modal para iniciar sesi칩n y registrarse -->
    <div id="popupAuth" class="popup hidden">
        <div class="popup-content">
            <span class="close" onclick="cerrarPopupAuth()">&times;</span>
            <h2 id="authTitle">Iniciar Sesi칩n</h2>
            <input type="email" id="authEmail" placeholder="Correo Electr칩nico" required>
            <input type="password" id="authPassword" placeholder="Contrase침a" required>
            <button id="authAction" onclick="autenticarUsuario()">Ingresar</button>
        </div>
    </div>

    <!-- Popup modal -->
    <div id="popupForm" class="popup hidden">
        <div class="popup-content">
            <span class="close" onclick="cerrarPopup()">&times;</span>
            <h2 id="popupTitle">Agregar Pel칤cula/Serie</h2>
            <select class="entrada" type="text" id="nombre" placeholder="Nombre" required></select>
            <select class="entrada" name="tipo" id="tipo"></select>
            <input class="entrada" type="number" id="episodios" placeholder="N칰mero de Cap칤tulos (si es una serie)">
            <div class="categoria-select">
                <select name="categoria" id="categoria"></select>
                <button class="btnCategoriaAgr" id="agregarCategoriaBtn" onclick="abrirPopup('categoria')">+</button>
            </div>
            <label class="entrada">
                <h3 class="estado">Estado</h3>
                <input type="checkbox" id="completado"> <p id="completo">Pendiente</p>
            </label>
            <button id="agregarItem" onclick="agregarElemento()">Agregar</button>
            <button id="editarItem" class="hidden" onclick="guardarEdicion()">Guardar</button>
        </div>
    </div>

    <!-- Popup modal para agregar categor칤a -->
    <div id="popupFormCategoria" class="popup hidden">
        <div class="popup-content">
            <span class="close" onclick="cerrarPopupCategoria()">&times;</span>
            <h2>Agregar Categor칤a</h2>
            <input type="text" id="nuevaCategoria" placeholder="Nombre de la Categor칤a" required>
            <button id="agregarCategoria" onclick="agregarCategoria()">Agregar</button>
        </div>
    </div>
</body>
</html>
